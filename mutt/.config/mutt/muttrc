set folder = "~/.mail"
source ~/.config/mutt/mailboxes

set mailcap_path = ~/.config/mutt/mailcap
alternative_order text/plain text/enriched text/html
auto_view text/html

set my_name = "Greg Anders"
set realname = $my_name
set editor = `echo \$EDITOR`
set use_from = yes
set envelope_from = yes
set sendmail = msmtp
set edit_headers = yes

set alias_file = ~/.config/mutt/aliases
set sort_alias = alias
set reverse_alias = yes
source $alias_file

# Mailing Lists
source ~/.config/mutt/lists

# Store message headers locally to speed things up.  If hcache is a folder,
# Mutt will create sub cache folders for each account which may speeds things
# up even more.
set header_cache = ~/.cache/mutt/headers

# Store messages locally to speed things up, like searching message bodies.
# Can be the same folder as header_cache.
# This will cost important disk usage according to your e-mail amount.
set message_cachedir = ~/.cache/mutt/messages

set nm_default_uri = "notmuch://$HOME/.mail"
set nm_record = yes
set nm_record_tags = "-inbox,-unread,+archive,+sent"
set nm_unread_tag = "unread"

macro index \\ "<vfolder-from-query>"
macro index,pager A "<save-message>=Archive\n<sync-mailbox>" "Archive message"
macro index,pager X "<change-vfolder>?" "Change to vfolder overview"
bind index,pager + entire-thread
bind index < vfolder-window-backward
bind index > vfolder-window-forward

# Colorscheme
source ~/.config/mutt/colors/base16.muttrc

# g is group-reply by default, we'll map that to R instead
bind  index,pager g   noop
bind  index       gg  first-entry

# G is fetch-mail by default, since I use offlineimap I don't ever fetch mail
# from a pop server
bind  index       G   last-entry

bind  index,pager ]   next-undeleted
bind  index,pager [   previous-undeleted

# Navigate like vim
bind  index,pager \Cu previous-page
bind  index,pager \Cd next-page
bind  pager       j   next-line
bind  pager       k   previous-line
macro pager       gg  <top><refresh>
macro pager       G   <bottom><refresh>

# Bind R to group-reply
bind  index,pager R   group-reply

# For some reason the screen gets borked after closing a message and requires a
# redraw
macro pager       q   <exit><refresh>

folder-hook .          source ~/.config/mutt/config.default
folder-hook "Personal" source ~/.config/mutt/config.personal

# Set up notmuch virtual mailboxes
set virtual_spoolfile = no

virtual-mailboxes "Inbox" "notmuch://?query=tag:inbox and not tag:archive"
virtual-mailboxes "Archive" "notmuch://?query=tag:archive"
virtual-mailboxes "Sent" "notmuch://?query=tag:sent"
virtual-mailboxes "Trash" "notmuch://?query=tag:trash"

# Use Personal mailbox as default
source ~/.config/mutt/config.personal
