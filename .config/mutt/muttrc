set realname = "Gregory Anders"

# Settings for handling MIME types
set mailcap_path = ~/.config/mutt/mailcap
alternative_order text/calendar text/plain text/enriched text/html
unauto_view *
auto_view text/calendar
auto_view text/html
auto_view text/x-diff
auto_view text/x-patch

# The bgedit.sh script launches the editor in a new pane if tmux is active.
# Otherwise it just starts the editor as normal.
set editor = "~/.local/share/mutt/bgedit.sh `echo $EDITOR`"
set background_edit = `[ -n "$TMUX" ] && echo 'yes' || echo 'no'`

set use_envelope_from
set sendmail = msmtp

set alias_file = ~/.local/share/mutt/aliases
source $alias_file

# Skip to compose when replying
set fast_reply

# Format of subject when forwarding
set forward_format = "Fwd: %s"

# Format of quoting header
set attribution = "On %{%a, %d %b %Y at %H:%M %z}, %n wrote:"

# Include message in replies
set include

# Time before Mutt gives up waiting for user input (default is 600)
set timeout = 10

# Force UTF-8
set send_charset = "utf-8"

# Enable text_flowed formatting
set text_flowed

# Don't mark messages as "old" if they're still unread
set mark_old = no

# Don't ask to append messages to a mailbox
set confirmappend = no

# Don't ask to delete messages, just do it
set delete = yes

# Don't move cursor after applying an action to a message (e.g. deleting or tagging)
set resolve = no

# Automatically apply actions to all tagged messages. This is how most modern
# email clients work anyway
set auto_tag = yes

# Format of directory listings when using <change-folder>
set folder_format = "%t %N %-20.20f %?n?%8n?"

# Remove delay between switching folders
set sleep_time = 0

# Index view options
set date_format = "%a, %d %b %Y %H:%M:%S"
set index_format = " [%Z]  %-9@date@  %-20.20F %@list@%s"
index-format-hook date "~d<1d" "Today"
index-format-hook date "~d<2d" "Yesterday"
index-format-hook date "~d<1w" "%[%A]"
index-format-hook date "~d<1y" "%[%b %d]"
index-format-hook date "~A"    "%[%b %y]"

index-format-hook list "~l" "[%B] "

set pager_format = " %.50s / %n / %D%* %P "

set sort = threads
set sort_aux = reverse-last-date-received
set sort_re
set reply_regexp = "^(([Rr][Ee]?(\[[0-9]+\])?: *)?(\[[^]]+\] *)?)*"
set pager_index_lines = 10
set pager_context = 3
set pager_stop

# Scroll menus by one line instead of a whole page when crossing a screen
# boundary
set menu_scroll

# Don't show + signs for wrapped lines
unset markers

# Reply using the address the original email was sent to
set reverse_name

# ...but always use my real name
unset reverse_realname

# Colorized diffs and patches
color body red default "^diff \-.*"
color body yellow default "^index [a-f0-9].*"
color body green default "^\-\-\- .*"
color body red default "^[\+]{3} .*"
color body green default "^[\+][^\+]+.*"
color body red  default "^\-[^\-]+.*"
color body blue default "^@@ .* @@"

# Cache message headers and bodies
set message_cachedir = ~/.cache/mutt/
set header_cache = ~/.cache/mutt/

# Where to store certificates
set certificate_file = ~/.cache/mutt/certificates

set status_format = "    %m messages%?n? (%n new)?%?d? (%d to delete)?%?t? (%t tagged)? %?p?(%p postponed)? %>"

# The script below takes the plain text email on its stdin and produces
# HTML-ized output using a Markdown to HTML converter
set send_multipart_alternative_filter = ~/.local/share/mutt/md2html.sh

# Offer to send multipart/alternative emails when replying to a text/html email
reply-hook . 'set send_multipart_alternative = no'
reply-hook '~M text/html' 'set send_multipart_alternative = ask-yes'

# '! ~Q' means "not replied" and matches on messages that are not replies
send-hook '! ~Q' 'set send_multipart_alternative = no'

# Save history to file
set history_file = ~/.cache/mutt/history
set save_history = 10

# Disable signature
unset signature

# Use GPGME for encryption
set crypt_use_gpgme

set pgp_default_key = "0x56E93C2FB6B08BDB"

# Set default directory to save attachments into
set attach_save_dir = ~/Downloads

source ~/.config/mutt/colors.rc
source ~/.config/mutt/bindings.rc
source ~/.config/mutt/sidebar.rc
source ~/.config/mutt/lists.rc
source ~/.config/mutt/hooks.rc

# Source default account
source ~/.config/mutt/personal.rc
